import{c as t,_ as e,a as n}from"./tslib.es6-6e0f8414.js";import{i}from"./tauri-c3f7456b.js";import{t as r}from"./tauri-94e4ec1e.js";function o(t,o,s,u){return void 0===s&&(s=[]),e(this,void 0,void 0,(function(){return n(this,(function(e){return"object"==typeof s&&Object.freeze(s),[2,i({__tauriModule:"Shell",message:{cmd:"execute",program:o,args:s,options:u,onEventFn:r(t)}})]}))}))}var s=function(){function t(){this.eventListeners=Object.create(null)}return t.prototype.addEventListener=function(t,e){t in this.eventListeners?this.eventListeners[t].push(e):this.eventListeners[t]=[e]},t.prototype._emit=function(t,e){if(t in this.eventListeners)for(var n=0,i=this.eventListeners[t];n<i.length;n++){(0,i[n])(e)}},t.prototype.on=function(t,e){return this.addEventListener(t,e),this},t}(),u=function(){function t(t){this.pid=t}return t.prototype.write=function(t){return e(this,void 0,void 0,(function(){return n(this,(function(e){return[2,i({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:"string"==typeof t?t:Array.from(t)}})]}))}))},t.prototype.kill=function(){return e(this,void 0,void 0,(function(){return n(this,(function(t){return[2,i({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})]}))}))},t}(),a=function(i){function r(t,e,n){void 0===e&&(e=[]);var r=i.call(this)||this;return r.stdout=new s,r.stderr=new s,r.program=t,r.args="string"==typeof e?[e]:e,r.options=null!=n?n:{},r}return t(r,i),r.sidecar=function(t,e,n){void 0===e&&(e=[]);var i=new r(t,e,n);return i.options.sidecar=!0,i},r.prototype.spawn=function(){return e(this,void 0,void 0,(function(){var t=this;return n(this,(function(e){return[2,o((function(e){switch(e.event){case"Error":t._emit("error",e.payload);break;case"Terminated":t._emit("close",e.payload);break;case"Stdout":t.stdout._emit("data",e.payload);break;case"Stderr":t.stderr._emit("data",e.payload)}}),this.program,this.args,this.options).then((function(t){return new u(t)}))]}))}))},r.prototype.execute=function(){return e(this,void 0,void 0,(function(){var t=this;return n(this,(function(e){return[2,new Promise((function(e,n){t.on("error",n);var i=[],r=[];t.stdout.on("data",(function(t){i.push(t)})),t.stderr.on("data",(function(t){r.push(t)})),t.on("close",(function(t){e({code:t.code,signal:t.signal,stdout:i.join("\n"),stderr:r.join("\n")})})),t.spawn().catch(n)}))]}))}))},r}(s);function c(t,r){return e(this,void 0,void 0,(function(){return n(this,(function(e){return[2,i({__tauriModule:"Shell",message:{cmd:"open",path:t,with:r}})]}))}))}var d=Object.freeze({__proto__:null,Command:a,Child:u,EventEmitter:s,open:c});export{a as C,s as E,u as a,c as o,d as s};
